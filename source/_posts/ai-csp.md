---
title: "WIP: [MLOps] 멍청한 내 사이드 프로젝트를 Intelligent 하게 만들어보자"
date: 2022-03-06 20:28:59
tags: [MLOps, AI, Cloud]
---

# MOTIVATION

작년 상반기에 구상하여 하반기에 기획 & 개발하고, 연말에 공모전에 냈던 나의 애증의 사이드 프로젝트...
퇴근하고 저녁, 주말에만 개발하느라 시간도 부족했는데 또 발등에 불 떨어질 때까지 미루는 바람에 실제로는 한 달안에 우다다 만들어서
코드도 못생기고 기능도 허접해서 다시 꺼내보고 싶지 않았는데... 요즘 문득 다시 만들어볼까 생각이 들어서 꺼내봤다.

기억과 그대로 소스코드는 지저분했지만, 리소스가 아깝기도 하고 작년 하반기 대비 내 실력이 얼마나 늘었는지도 볼 겸 모바일앱으로 전환을 해보기로 마음먹었다.

그리고 이 꼬질꼬질한 친구를 더 멋드러지게 만들기 위해, 작년에 기획만 하고 우선순위에 밀려 구현되지 못했던 장소 추천 기능을 넣어보려고한다.

이 포스트에서는 어떻게 추천 서비스를 1.구상하고 2.조사하고 3.이해하고 4.구현했는지 정리할 것이다.

# 구상하기

## 당신과 유사한 사용자가 본 컨텐츠 vs 당신이 관심있었던 컨텐츠와 유사한 컨텐츠

**사용자 기반의 추천** / **컨텐츠 기반의 추천** 둘 중 어느 방향으로 추천을 구현할까 고민이 있었는데
나와 유사한 사용자가 어떤 선택을 내렸는가에 기반하여 추천을 하려면 일단 일정 규모 이상의 사용자 풀이 확보되어야한다는 점이 마음에 걸렸고,

- 사용자 풀을 방대하게 늘리고 싶은 욕심이 없고
- 소수의 충성스러운 사용자를 확보하고 싶은

나로서는 **컨텐츠 기반의 추천**을 선택하는 것이 유리하다고 판단했다.

따라서 일차적으로는 내 컨텐츠의 카테고리를 분류하고, 사용자로부터 선호하는 카테고리를 수집한 것이 작년까지의 작업 내용이다.

## 그런데 어느 컨텐츠에 관심이 있으셨죠?

위에서 언급했듯이 컨텐츠 기반으로 추천을 하겠다는 결정과 초기 작업은 작년에 이미 해둔 상태이지만, 이번에 좀 더 잘 다듬어보려고 고심하면서 심화 기능을 생각하자니 뭔가 문제가 좀 있었다.
![애증의 사이드 프로젝트](/images/playwith_preference_draft.png)

- 초기에 선택한 카테고리에 대한 흥미도가 시간이 지남에 따라 변함
  그렇다고 사용자가 스스로 취향이 바뀌었다는 것을 인지하고 -> 정보 설정 화면에 진입해서 -> 카테고리를 다시 고르게 하는 것은 검색창의 필터 기능이랑 다른점이 무엇인지? "추천"이라고 쓰고 "검색"이라고 읽어야하나?
- 제한된 카테고리 내에서 선택을 하다보니 세밀한 취향 선택이 어렵고, 당연히 추천에 대한 만족도도 떨어짐
  그렇다고 카테고리 수를 늘리는 것은 UX 피로도를 높이고 심미성도 떨어지는데...

**요약하자면** 사용자에게 '너의 취향을 골라보라'고 카테고리 몇 가지를 제시하고 입력받는 것 만으로는 사용자의 취향을 자세히 알 수가 없다는 점이 걱정되기 시작했다.
**결론적으로**, 사용자가 서비스 내에서 어떤 행동을 했는지 로깅하고, 해당 로그를 활용하여 사용자가 어떤 정보에 흥미를 느끼는지 파악하는 파이프라인을 마련해야할 필요가 있었다.

## 그렇다면 어떤 정보를 수집하고, 수집된 정보를 어떻게 취향의 근거로 활용할까?

인스타 추천알고리즘이나 유튭 추천알고리즘이 어떤 정보를 수집해간다더라 이것저것 들은 이야기는 있지만, 실제로 내부가 어찌 되어있는지 자세히 알 방도도 없을 뿐더러 내 시간과 비용으로 그 정도 구현은 어렵기 때문에 우선은 몇 가지 action에 대한 측정값을 수집하는 정도로만 먼저 데이터를 모아보기로 했다.

의미가 있다고 판단한 action은 주로 조회나 화면과의 상호작용 정도이다. 한 가지 나름 신경썼다고 생각하는 특이점으로는 서비스 자체가 메인 추천화면 -> 장소 상세화면 -> 장소 상세화면의 세부 정보별 상호작용 (장소 내용 자세히보기, 주변관광지 추천, 지도연동 등등)과 같이 안쪽으로 타고 들어와야만 정보의 질이 높아지는 구조로, 유용한 정보를 얻고자 하는 사용자라면 장소상세 화면 안쪽까지 들어와야만 한다는 점에 착안하여 **화면 depth에 대한 가중치를 부여**하려고한다는 점이다.

## 취향에 맞는 컨텐츠를 제공하기 위해 선행되어야할 작업은 뭘까? 컨텐츠 카테고리를 정확하고 자세하게 정하는 것?

작년 버전의 소스에서는 박물관, 미술관 등의 N가지 카테고리를 대분류로 장소 별 특색에 따라 하위의 분류를 얼추 정해놓았다. 관광공사에서 제공하는 api를 사용하는 것도 프로젝트의 큰 목적이었기때문에, 관광공사에서 제공하는 카테고리를 거의 그대로 가져다 썼다.

이 다중 트리 구조의 카테고리가 내가 만들고자하는 추천 서비스에 적합한 데이터 구조일까? 제공되는 카테고리가 마음에 들지 않는데, 시간과 노력을 들여 좀 더 세밀하게 / 정확하게 트리의 리프 카테고리까지 검수해야할까? (실제로 작년에는 이 검수 작업을 하려고 했었다)
약간의 고민 만으로도 이 접근은 잘못되었다는 것을 알 수 있었다. 트리 구조의 자세한 분류 체계는 내가 구현하고자 하는 추천 시스템에서 상대적으로 덜 중요한 작업이다.

대신 내가 장소의 feature로 고려할 수 있는 항목이 무엇이 있을지 고민하면 되겠다고 판단했다.

**결론적으로**, 나는 제목의 "취향에 맞는 컨텐츠를 제공하기 위해 선행되어야할 작업은 뭘까?"에 대한 답을 "장소에 대한 feature를 정하자"로 내린 것이다.

내가 타겟이라고 생각했던 유저층의 마음으로 웹서핑을 하며 몇 가지 feature 를 뽑아보니, 원래부터도 카테고리로 사용하고 있던 **현장학습 지식의 분야**(역사/과학/미술 등등) 외에도 **적정 연령대**, **대중교통 가능 여부** 등등 꽤 여러가지 feature가 뽑혔다.

# 조사하기

## 사용자의 action 이력을 수집하는 방법은 뭐가 있을까?

어플리케이션에 Action 로깅을 심는 방법에 대해 이것저것 구글링해봤다. 웹에서는 이전부터 많이 쓰였어서 그런지, 구글링 결과가 아주 방대했고 기획 & 마케팅 초짜인 나는 어떤 서비스를 사용해야할 지 찾기 어려웠다. 결국엔 그냥 여러 아티클과 블로그를 둘러보며 감이라도 잡는 수 밖에 없었다 😅

- [MLOps란 무엇일까?](https://medium.com/daria-blog/mlops-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C-7ba8d9aae221): 와! 요즘 블로그에서 많이 보이는 복붙된 지식이 준초콜릿 같은거라면 이런 고디바 같은 글도 있다 ㅠㅠ 감격
- [행동 데이터 분석가를 위한 안내서 - 나(또는 우리 회사)에 맞는 애널리틱스 선택하기](https://brunch.co.kr/@userhabit/52) : 결론은 광고글인 것 같긴한데, 어떤 솔루션이 유명한지조차 모르는 나에게는 도움이 되었다
- [Apple의 앱 추적 투명성 정책](https://www.itworld.co.kr/news/191844) : 어우 언제부턴가 추적을 허용하겠냐는 팝업이 떠서 당연히 매번 거부했는데 ㅎㅎ 정책이었다니! 너무 무지했던 것 같다;
- [위에 언급된 ATT로인해 UX적으로 고려해야하는 것](https://www.adjust.com/ko/blog/opt-in-design-for-apple-app-tracking-transparency-att-ios14/): 관련은 없는데 재밌어서 기록한다. 역시 UX는 재밌다.

## 사용자의 action 이력과 가중치를 넘기면 이 사용자의 feature 별 관심도를 뽑아주는 서비스나 모델이 뭐가 있을까?

## 특정 사용자의 feature 별 관심도를 넘기면 그 사용자에게 추천할만한 데이터를 뽑아주는 서비스나 모델이 뭐가 있을까?
